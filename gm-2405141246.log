Start installing ROSA HCP cluster gm-2405141246 in a Single-AZ ...
{
    "UserId": "AIDAZHWQV3JOTIOBCZC4R",
    "Account": "635019057757",
    "Arn": "arn:aws:iam::635019057757:user/open-environment-td9nl-admin"
}
{
    "Role": {
        "Path": "/aws-service-role/elasticloadbalancing.amazonaws.com/",
        "RoleName": "AWSServiceRoleForElasticLoadBalancing",
        "RoleId": "AROAZHWQV3JO6AXE25ABX",
        "Arn": "arn:aws:iam::635019057757:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing",
        "CreateDate": "2019-09-07T15:14:23+00:00",
        "AssumeRolePolicyDocument": {
            "Version": "2012-10-17",
            "Statement": [
                {
                    "Effect": "Allow",
                    "Principal": {
                        "Service": "elasticloadbalancing.amazonaws.com"
                    },
                    "Action": "sts:AssumeRole"
                }
            ]
        },
        "Description": "Allows ELB to call AWS services on your behalf.",
        "MaxSessionDuration": 3600,
        "RoleLastUsed": {
            "LastUsedDate": "2024-05-13T16:54:42+00:00",
            "Region": "us-east-2"
        }
    }
}
#
Creating the VPC:  vpc-0dc1c53a4801da976
VPC_ID_VALUE  vpc-0dc1c53a4801da976
Creating the Public Subnet:  subnet-0680fa35f3d5d5781
Creating the Private Subnet:  subnet-021677ff6d5c9d8c9
Creating the IGW:  igw-08603516b1cf02a9f
Creating the Public Route Table:  rtb-08fa137f9cf098f7d
{
    "Return": true
}
{
    "AssociationId": "rtbassoc-06e3553f33be8b0cd",
    "AssociationState": {
        "State": "associated"
    }
}
Creating the NGW:  nat-06dac9b8d5497cb6a
Waiting for NGW to warm up 
Creating the Private Route Table:  rtb-0f12ffc600f15499f
{
    "Return": true
}
{
    "AssociationId": "rtbassoc-0ecc9eb939b3993c2",
    "AssociationState": {
        "State": "associated"
    }
}
#
VPC creation ... done! 
#
Going to create account and operator roles ...
INFO: Creating hosted CP account roles using 'arn:aws:iam::635019057757:user/open-environment-td9nl-admin'
INFO: Created role 'gm-2405141246-HCP-ROSA-Support-Role' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Support-Role'
INFO: Created role 'gm-2405141246-HCP-ROSA-Worker-Role' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Worker-Role'
INFO: Created role 'gm-2405141246-HCP-ROSA-Installer-Role' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Installer-Role'
Creating the OIDC config 2b8f7ptjeueeedeb2i497rooki2ae3n4
OIDC_ID  2b8f7ptjeueeedeb2i497rooki2ae3n4
Creating operator-roles
INFO: Creating roles using 'arn:aws:iam::635019057757:user/open-environment-td9nl-admin'
INFO: Created role 'gm-2405141246-openshift-cloud-network-config-controller-cloud-cr' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-openshift-cloud-network-config-controller-cloud-cr'
INFO: Created role 'gm-2405141246-kube-system-control-plane-operator' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-kube-system-control-plane-operator'
INFO: Created role 'gm-2405141246-kube-system-kms-provider' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-kube-system-kms-provider'
INFO: Created role 'gm-2405141246-kube-system-kube-controller-manager' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-kube-system-kube-controller-manager'
INFO: Created role 'gm-2405141246-kube-system-capa-controller-manager' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-kube-system-capa-controller-manager'
INFO: Created role 'gm-2405141246-openshift-image-registry-installer-cloud-credentia' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-openshift-image-registry-installer-cloud-credentia'
INFO: Created role 'gm-2405141246-openshift-ingress-operator-cloud-credentials' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-openshift-ingress-operator-cloud-credentials'
INFO: Created role 'gm-2405141246-openshift-cluster-csi-drivers-ebs-cloud-credential' with ARN 'arn:aws:iam::635019057757:role/gm-2405141246-openshift-cluster-csi-drivers-ebs-cloud-credential'
Creating ROSA HCP cluster 
INFO: Creating cluster 'gm-2405141246'
INFO: To view a list of clusters and their status, run 'rosa list clusters'
INFO: Cluster 'gm-2405141246' has been created.
INFO: Once the cluster is installed you will need to add an Identity Provider before you can login into the cluster. See 'rosa create idp --help' for more information.

Name:                       gm-2405141246
Domain Prefix:              gm-2405141246
Display Name:               gm-2405141246
ID:                         2b8f86fchl1no6t1fd2oa56a0438vhbj
External ID:                eedb2363-9897-4ba1-ae8f-e4a7514972ce
Control Plane:              ROSA Service Hosted
OpenShift Version:          4.14.23
Channel Group:              stable
DNS:                        Not ready
AWS Account:                635019057757
AWS Billing Account:        635019057757
API URL:                    
Console URL:                
Region:                     us-east-2
Availability:
 - Control Plane:           MultiAZ
 - Data Plane:              SingleAZ

Nodes:
 - Compute (desired):       2
 - Compute (current):       0
Network:
 - Type:                    OVNKubernetes
 - Service CIDR:            172.30.0.0/16
 - Machine CIDR:            10.0.0.0/16
 - Pod CIDR:                10.128.0.0/14
 - Host Prefix:             /23
 - Subnets:                 subnet-021677ff6d5c9d8c9, subnet-0680fa35f3d5d5781
EC2 Metadata Http Tokens:   optional
Role (STS) ARN:             arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Installer-Role
Support Role ARN:           arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Support-Role
Instance IAM Roles:
 - Worker:                  arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Worker-Role
Operator IAM Roles:
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-control-plane-operator
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-kms-provider
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-image-registry-installer-cloud-credentia
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-ingress-operator-cloud-credentials
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-cluster-csi-drivers-ebs-cloud-credential
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-cloud-network-config-controller-cloud-cr
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-kube-controller-manager
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-capa-controller-manager
Managed Policies:           Yes
State:                      waiting (Waiting for user action)
Private:                    No
Delete Protection:          Disabled
Created:                    May 14 2024 10:51:33 UTC
User Workload Monitoring:   Enabled
Details Page:               https://console.redhat.com/openshift/details/s/2gSH7YbNB0yiMYBo8MHbWN8kheC
OIDC Endpoint URL:          https://oidc.op1.openshiftapps.com/2b8f7ptjeueeedeb2i497rooki2ae3n4 (Managed)
Audit Log Forwarding:       Disabled
External Authentication:    Disabled

INFO: Preparing to create operator roles.
INFO: Operator Roles already exists
INFO: Preparing to create OIDC Provider.
INFO: Creating OIDC provider using 'arn:aws:iam::635019057757:user/open-environment-td9nl-admin'
INFO: Created OIDC provider with ARN 'arn:aws:iam::635019057757:oidc-provider/oidc.op1.openshiftapps.com/2b8f7ptjeueeedeb2i497rooki2ae3n4'
INFO: To determine when your cluster is Ready, run 'rosa describe cluster -c gm-2405141246'.
INFO: To watch your cluster installation logs, run 'rosa logs install -c gm-2405141246 --watch'.
Appending rosa installation logs to /Users/gmollo/tools/cluster/svil/rosa-hcp-fast-deploy/gm-2405141246.log 
INFO: Cluster 'gm-2405141246' is in waiting state waiting for installation to begin. Logs will show up within 5 minutes
0001-01-01 00:00:00 +0000 UTC hostedclusters gm-2405141246 Version 
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Condition not found in the CVO.
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 The hosted control plane is not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Condition not found in the CVO.
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Condition not found in the CVO.
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Condition not found in the CVO.
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 The hosted control plane is not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 The hosted control plane is not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 The hosted control plane is not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Condition not found in the CVO.
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Waiting for hosted control plane to be healthy
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 The hosted control plane is not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 The hosted control plane is not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 The hosted control plane is not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Ignition server deployment not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Configuration passes validation
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 HostedCluster is supported by operator configuration
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Release image is valid
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 ValidAWSIdentityProvider StatusUnknown
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 Reconciliation active on resource
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 failed to get referenced secret ocm-production-2b8f86fchl1no6t1fd2oa56a0438vhbj/cluster-api-cert: Secret "cluster-api-cert" not found
2024-05-14 10:53:54 +0000 UTC hostedclusters gm-2405141246 HostedCluster is at expected version
2024-05-14 10:55:48 +0000 UTC hostedclusters gm-2405141246 OIDC configuration is valid
2024-05-14 10:55:48 +0000 UTC hostedclusters gm-2405141246 Reconciliation completed successfully
2024-05-14 10:55:53 +0000 UTC hostedclusters gm-2405141246 WebIdentityErr
2024-05-14 10:55:54 +0000 UTC hostedclusters gm-2405141246 All is well
2024-05-14 10:55:54 +0000 UTC hostedclusters gm-2405141246 lookup api.gm-2405141246.p2ze.p3.openshiftapps.com on 172.30.0.10:53: no such host
2024-05-14 10:55:54 +0000 UTC hostedclusters gm-2405141246 capi-provider deployment has 1 unavailable replicas
2024-05-14 10:55:54 +0000 UTC hostedclusters gm-2405141246 Configuration passes validation
2024-05-14 10:55:54 +0000 UTC hostedclusters gm-2405141246 AWS KMS is not configured
2024-05-14 10:55:54 +0000 UTC hostedclusters gm-2405141246 EtcdAvailable StatefulSetNotFound
2024-05-14 10:55:54 +0000 UTC hostedclusters gm-2405141246 Kube APIServer deployment not found
2024-05-14 10:56:02 +0000 UTC hostedclusters gm-2405141246 All is well
2024-05-14 10:56:55 +0000 UTC hostedclusters gm-2405141246 EtcdAvailable QuorumAvailable
2024-05-14 10:58:02 +0000 UTC hostedclusters gm-2405141246 Kube APIServer deployment is available
2024-05-14 10:58:13 +0000 UTC hostedclusters gm-2405141246 All is well
2024-05-14 10:59:08 +0000 UTC hostedclusters gm-2405141246 [catalog-operator deployment has 1 unavailable replicas, certified-operators-catalog deployment has 2 unavailable replicas, cluster-autoscaler deployment has 1 unavailable replicas, cluster-image-registry-operator deployment has 1 unavailable replicas, cluster-network-operator deployment has 1 unavailable replicas, cluster-storage-operator deployment has 1 unavailable replicas, community-operators-catalog deployment has 2 unavailable replicas, csi-snapshot-controller-operator deployment has 1 unavailable replicas, dns-operator deployment has 1 unavailable replicas, hosted-cluster-config-operator deployment has 1 unavailable replicas, ignition-server deployment has 3 unavailable replicas, ingress-operator deployment has 1 unavailable replicas, machine-approver deployment has 1 unavailable replicas, oauth-openshift deployment has 2 unavailable replicas, olm-operator deployment has 1 unavailable replicas, packageserver deployment has 3 unavailable replicas, redhat-marketplace-catalog deployment has 2 unavailable replicas, redhat-operators-catalog deployment has 2 unavailable replicas, router deployment has 1 unavailable replicas]
2024-05-14 10:59:08 +0000 UTC hostedclusters gm-2405141246 All is well
2024-05-14 10:59:09 +0000 UTC hostedclusters gm-2405141246 The hosted control plane is available
INFO: Cluster 'gm-2405141246' is now ready

Name:                       gm-2405141246
Domain Prefix:              gm-2405141246
Display Name:               gm-2405141246
ID:                         2b8f86fchl1no6t1fd2oa56a0438vhbj
External ID:                eedb2363-9897-4ba1-ae8f-e4a7514972ce
Control Plane:              ROSA Service Hosted
OpenShift Version:          4.14.23
Channel Group:              stable
DNS:                        gm-2405141246.p2ze.p3.openshiftapps.com
AWS Account:                635019057757
AWS Billing Account:        635019057757
API URL:                    https://api.gm-2405141246.p2ze.p3.openshiftapps.com:443
Console URL:                
Region:                     us-east-2
Availability:
 - Control Plane:           MultiAZ
 - Data Plane:              SingleAZ

Nodes:
 - Compute (desired):       2
 - Compute (current):       0
Network:
 - Type:                    OVNKubernetes
 - Service CIDR:            172.30.0.0/16
 - Machine CIDR:            10.0.0.0/16
 - Pod CIDR:                10.128.0.0/14
 - Host Prefix:             /23
 - Subnets:                 subnet-021677ff6d5c9d8c9, subnet-0680fa35f3d5d5781
EC2 Metadata Http Tokens:   optional
Role (STS) ARN:             arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Installer-Role
Support Role ARN:           arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Support-Role
Instance IAM Roles:
 - Worker:                  arn:aws:iam::635019057757:role/gm-2405141246-HCP-ROSA-Worker-Role
Operator IAM Roles:
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-control-plane-operator
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-kms-provider
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-image-registry-installer-cloud-credentia
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-ingress-operator-cloud-credentials
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-cluster-csi-drivers-ebs-cloud-credential
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-cloud-network-config-controller-cloud-cr
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-kube-controller-manager
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-capa-controller-manager
Managed Policies:           Yes
State:                      ready 
Private:                    No
Delete Protection:          Disabled
Created:                    May 14 2024 10:51:33 UTC
User Workload Monitoring:   Enabled
Details Page:               https://console.redhat.com/openshift/details/s/2gSH7YbNB0yiMYBo8MHbWN8kheC
OIDC Endpoint URL:          https://oidc.op1.openshiftapps.com/2b8f7ptjeueeedeb2i497rooki2ae3n4 (Managed)
Audit Log Forwarding:       Disabled
External Authentication:    Disabled

Creating the cluster-admin user
INFO: Admin account has been added to cluster 'gm-2405141246'.
INFO: Please securely store this generated password. If you lose this password you can delete and recreate the cluster admin user.
INFO: To login, run the following command:

   oc login https://api.gm-2405141246.p2ze.p3.openshiftapps.com:443 --username cluster-admin --password WnD3F-Pa6hd-TUB5y-DMuIN

INFO: It may take several minutes for this access to become active.
 
 
 
++ echo '\033[1;32m'
+ msgcolor='\033[1;32m'
++ echo '\033[00;00m'
+ normal='\033[00;00m'
+ message='Done!!!'
+ printf '\033[1;32mDone!!!\033[00;00m\n'
[1;32mDone!!![00;00m
++ echo '\033[1;32m'
+ msgcolor='\033[1;32m'
++ echo '\033[00;00m'
+ normal='\033[00;00m'
+ message='Cluster gm-2405141246 has been installed and is now up and running'
+ printf '\033[1;32mCluster gm-2405141246 has been installed and is now up and running\033[00;00m\n'
[1;32mCluster gm-2405141246 has been installed and is now up and running[00;00m
++ echo '\033[1;32m'
+ msgcolor='\033[1;32m'
++ echo '\033[00;00m'
+ normal='\033[00;00m'
+ message='Please allow a few minutes before to login, for additional information check the /Users/gmollo/tools/cluster/svil/rosa-hcp-fast-deploy/gm-2405141246.log file'
+ printf '\033[1;32mPlease allow a few minutes before to login, for additional information check the /Users/gmollo/tools/cluster/svil/rosa-hcp-fast-deploy/gm-2405141246.log file\033[00;00m\n'
[1;32mPlease allow a few minutes before to login, for additional information check the /Users/gmollo/tools/cluster/svil/rosa-hcp-fast-deploy/gm-2405141246.log file[00;00m
 
 
 
Deleting the jump-host ID  i-0942bdb427d869cc6
{
    "TerminatingInstances": [
        {
            "CurrentState": {
                "Code": 32,
                "Name": "shutting-down"
            },
            "InstanceId": "i-0942bdb427d869cc6",
            "PreviousState": {
                "Code": 16,
                "Name": "running"
            }
        }
    ]
}
Deleting the key-pair named  pippo.key
{
    "Return": true,
    "KeyPairId": "key-09050295a57674551"
}
#
# Start deleting ROSA HCP cluster gm-2405141246, VPC, roles, etc. 
# Further details can be found in /Users/gmollo/tools/cluster/svil/rosa-hcp-fast-deploy/gm-2405141246.log LOG file
#
INFO: Cluster 'gm-2405141246' will start uninstalling now
INFO: Your cluster 'gm-2405141246' will be deleted but the following objects may remain
INFO: Operator IAM Roles: - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-control-plane-operator
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-kms-provider
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-image-registry-installer-cloud-credentia
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-ingress-operator-cloud-credentials
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-cluster-csi-drivers-ebs-cloud-credential
 - arn:aws:iam::635019057757:role/gm-2405141246-openshift-cloud-network-config-controller-cloud-cr
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-kube-controller-manager
 - arn:aws:iam::635019057757:role/gm-2405141246-kube-system-capa-controller-manager

INFO: OIDC Provider : https://oidc.op1.openshiftapps.com/2b8f7ptjeueeedeb2i497rooki2ae3n4

INFO: Once the cluster is uninstalled use the following commands to remove the above aws resources.

	rosa delete operator-roles --prefix gm-2405141246
	rosa delete oidc-provider --oidc-config-id 2b8f7ptjeueeedeb2i497rooki2ae3n4
INFO: To watch your cluster uninstallation logs, run 'rosa logs uninstall -c gm-2405141246 --watch'
{
    "NatGatewayId": "nat-06dac9b8d5497cb6a"
}
Cluster deletion in progress 
2024-05-14 14:18:54 +0000 UTC hostedclusters gm-2405141246 Reconciliation completed successfully
